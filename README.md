# Collector


![Logo](Images/Collector128.png)

This powershell script will recursively collect multiple text files within a single directory
and insert them into a single file. The trick is that you can specify which files
to collect with a special tag in the first line of that document. A few different
tag options will allow you to perform different operations at run time.

This was developed for use when developing complicated Inventor iLogic routines,
or collecting Autocad Lisp routines into a single file. Though this tool maybe
used for just about any source code file.

It is also useful when developing an Inventor Add-In and you want to perform testing
in the iLogic environment.  The script will collect any source code files within a
single directory that contains the proper tag in the first line and insert them into
a single iLogic file.

## Control Tags

To use, include tags into the source code files that you want to collect. You may comment
these tags out for whatever source code you're using.  E.g. for VB, the tag would read
`'</Collector>`, for AutoLISP it would read `;</Collector>`.

* ``</Collector>`` : include this tag in the first line of each file you want to collect.
* ``</CollectorHeader>`` : Include this tag in the first line of header and main files. This will ensure the file is placed at the top of the collected file.  This is useful for header statements and includes.
* ``<CollectorPrepend>;</CollectorPrepend>`` : You may prepend a line with characters in the final collected file by placing the character between these tags.  E.g. for Inventor ilogic routines, use this to comment out module declarations and include statements.  These module declarations make the code readable in Visual Studio, but need to be removed for iLogic to work properly.

## Parameters

 When ready to compile, run this powershell script to combine the files into a single file. There are several command
 line parameters you may use:

`-Watch` : the directory to scan.  The path may be relative to the script location or absolute.
			 E.g. -Watch "src", or -Watch "C:\dev\project\" will only scan files within those directories.

`-Out` : Specifies the output file name that collector will generate. The path may be relative to the script location
			 or absolute.  The default "build/build.vb" filename is used if none is specified.  This script will overwrite any file with that same name.  If the file is currently open, it will need to be closed or deleted to proceed.
		     

`-Filter` : an optional wildcard glob that will speed up the collection process by restricting the scanned files to
			  matches.  E.g. -Filter "*.vb" will instruct collector to only scan files ending in .vb.

 User defaults for these parameters can be set within the file.


If running from the command line, you may need to issue the command like so if permissions
issues prevent running the powershell script.

``powershell -ExecutionPolicy ByPass -File .\Collector.ps1``


## Example

See the /Example/ folder for a simple set of code files that illustrates Collector
in action. The Example.iLogicVB file has been generated by the collector.ps1 script.
The files "ExporterClass.vb", "Main.vb", and "SphereClass.vb" contain the Collector
tags that tells the script what to do.
